{% extends "base.html" %}
{% block title %} Server Details {% endblock %}
{% block main_content %}
    <style>
    .container{
        max-width: 900px;
        margin-top:.75rem;
    }
    .return{
        padding: 0.15em 0.5em;
        border: 1px solid #ccc;
        border-radius: 0.5rem;
    }
    .card{
        padding: 1rem;
        margin-top:.75rem;
    }
    .bottom-margin{
        margin-bottom: 0.4rem
    }
    .no-top-bottom-margin{
        margin-top: 0;
        margin-bottom: 0;
    }
    </style>
    <section class="container">
        <a href="{% url "dashboard" %}" class="invis-a return hover-effect">Back to Dashboard</a>

        <article class="card">
            <header class='bottom-margin' style="text-align: center">
                <h2 style="margin: 0;">
                    {{ service.name }}
                </h2>
                <h3 style="margin: 0;">
                    {{ service_type.name }}
                </h3>
            </header>
            <section>
                <h3 class='no-top-bottom-margin'>Service Information</h3>
                <h4 class="no-top-bottom-margin">Service located on: {{ server.hostname }}</h4>
                <hr>
                <div class="grid">
                    <div>
                    <div>
                        <h4 class='bottom-margin'>Service Info</h4>
                        <ul>
                            <li><strong>Name:</strong> {{ service.name }}</li>
                            <li><strong>Host:</strong> {{ service.hostname }}:{{ service.port }}</li>
                            <li><strong>Status:</strong> {{ service.status }}</li>
                            <li><strong>Type:</strong> {{ service.type }}</li>
                        </ul>
                    </div>
                    {% for single in probe %}
                        <h4 class='bottom-margin'>Probe {{ single.id }}</h4>
                       <ul>
                           <li><strong>Probe Type: </strong> {{ single.probe_type }}</li>
                           <li><strong>Probe Target: </strong> {{ single.target }}</li>
                           <li><strong>Probe Interval: </strong> {{ single.interval_seconds }}</li>
                           <li><strong>Probe Timeout: </strong> {{ single.timeout_seconds }}</li>
                           <li><strong>Probe Status: </strong> {% if single.enabled %} UP {% else %} DOWN {% endif %}</li>
                           <li><strong>Additional Settings: </strong> {% if single.settings %} {{ single.settings }} {% else %} No Additional Settings {% endif %}</li>
                       </ul>
                            <ul>
                              <details style="margin-top: 0.5rem;">
                                <summary><h4>Check Results</h4></summary>
                                <ul>
                                  {% for result in check_results %}
                                    <ul>
                                      {{ result.timestamp|date:"Y-m-d H:i" }} â€”
                                      {{ result.result }}
                                      {% if result.latency_ms %} | Latency: {{ result.latency_ms }} ms{% endif %}
                                      {% if result.http_status %} | HTTP: {{ result.http_status }}{% endif %}
                                      {% if result.error %} | Error: {{ result.error }}{% endif %}
                                      {% if result.extra %} | Extra: {{ result.extra }}{% endif %}
                                    </ul>
                                  {% empty %}
                                    <li><strong>No Results</strong></li>
                                  {% endfor %}
                                </ul>
                              </details>
                            </ul>
                       </ul>
                    {% empty %}
                    <li><strong>No Probes</strong></li>
                    {% endfor %}
                </div>
                </div>
            </section>
        </article>
    </section>
{% endblock %}